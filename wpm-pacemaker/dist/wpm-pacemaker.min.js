(function () {function j(a){return a&&a.__esModule?{d:a.default}:{d:a}}var b={};var d,f={},a=arguments[0];!function(t){let e=[];const n=Array.prototype.forEach;function r(t){const e=[];let n=0;const r=t.length;for(;n<r;){const o=t.charCodeAt(n++);if(o>=55296&&o<=56319&&n<r){const r=t.charCodeAt(n++);56320==(64512&r)?e.push(((1023&o)<<10)+(1023&r)+65536):(e.push(o),n--)}else e.push(o)}return e}function o(t,e){const n=Object.prototype.toString.call(t),r="string"==typeof t||"[object NodeList]"===n||"[object HTMLCollection]"===n||1===t.nodeType,o="function"==typeof e;return r||console.error("Countable: Not a valid target"),o||console.error("Countable: Not a valid callback function"),r&&o}function i(t,e){let o=""+("string"==typeof t?t:"value"in t?t.value:t.textContent);(e=e||{}).stripTags&&(o=o.replace(/<\/?[a-z][^>]*>/gi,"")),e.ignore&&n.call(e.ignore,function(t){o=o.replace(t,"")});const i=o.trim();return{paragraphs:i?(i.match(e.hardReturns?/\n{2,}/g:/\n+/g)||[]).length+1:0,sentences:i?(i.match(/[.?!…]+./g)||[]).length+1:0,words:i?(i.replace(/['";:,.?¿\-!¡]+/g,"").match(/\S+/g)||[]).length:0,characters:i?r(i.replace(/\s/g,"")).length:0,all:r(o).length}}const c={on:function(t,r,c){if(o(t,r))return Array.isArray(t)||(t=[t]),n.call(t,function(t){const n=function(){r.call(t,i(t,c))};e.push({element:t,handler:n}),n(),t.addEventListener("input",n)}),this},off:function(t){if(o(t,function(){}))return Array.isArray(t)||(t=[t]),e.filter(function(e){return-1!==t.indexOf(e.element)}).forEach(function(t){t.element.removeEventListener("input",t.handler)}),e=e.filter(function(e){return-1===t.indexOf(e.element)}),this},count:function(t,e,r){if(o(t,e))return Array.isArray(t)||(t=[t]),n.call(t,function(t){e.call(t,i(t,r))}),this},enabled:function(t){return void 0===t.length&&(t=[t]),e.filter(function(e){return-1!==t.indexOf(e.element)}).length===t.length}};"object"==typeof f?f=c:"function"==typeof d&&d.amd?d(function(){return c}):t.Countable=c}(f);class k{constructor(t){this._root=t,this._resolve=null}_initializeOverlay(){if(!this._overlay){this._overlay=this._root.ownerDocument.createElement("div");const t=this._overlay.style;t.position="absolute",t.top=0,t.bottom=0,t.left=0,t.right=0,t.pointerEvents="none",t.userSelect="none",this._root.appendChild(this._overlay)}}_createInsNode(){const t=this._root.ownerDocument.createElement("ins"),e=t.style;return e.textDecoration="none",e.color="var(--lumin-color, currentColor)",e.background="var(--lumin-background-color, yellow)",t}_createBufferNode(){const t=this._root.ownerDocument.createElement("ins"),e=t.style;return e.textDecoration="none",e.color="transparent",e.opacity=0,t}_reset(){this._initializeOverlay(),this.stop(),this._map=[],this._charCount=0;const t=this._root.childNodes;for(let e=0;e<t.length;e++)t[e]!=this._overlay&&this._process(this._overlay,t[e])}_process(t,e){if(e.nodeType===Node.TEXT_NODE){const r=e.cloneNode(!1);r.textContent="";const n=e.textContent,o=this._createInsNode(),s=this._createBufferNode();o.appendChild(r),s.textContent=n,t.appendChild(o),t.appendChild(s);let i=n.length;i&&!n.trim().length&&(i=1),this._map.push({node:r,buffer:s,text:n,length:i,current:""}),this._charCount+=i}else if(e.nodeType===Node.ELEMENT_NODE){const r=e.cloneNode(!1);t.appendChild(r);const n=e.childNodes;if(n&&n.length)for(let t=0;t<n.length;t++)this._process(r,n[t])}}stop(){this._timer&&(clearTimeout(this._timer),delete this._timer),this._cancelPending()}clear(){this._overlay&&(this._root.removeChild(this._overlay),this._overlay=null)}start(t){return this._cancelPending(),this._overlay||this._reset(),this._charCount||(this._charCount=1),this._interval=t/this._charCount,this._cursor=0,new Promise(t=>{this._resolve=t,this._nextTick()})}_cancelPending(){this._resolve&&(this._resolve(!1),this._resolve=null)}_nextTick(){this._timer=setTimeout(()=>this._tick(),this._interval)}_tick(){if(this._cursor>=this._map.length)return void(this._resolve&&(this._resolve(!0),this._resolve=null));let t=this._map[this._cursor];t.text.length-t.current.length<=0?(this._cursor++,this._tick()):(t.length?t.current=t.text.substring(0,t.current.length+1):t.current=t.text,t.node.textContent=t.current,t.buffer.textContent=t.text.substring(t.current.length),this._nextTick())}set progress(t){this.clear(),this._overlay||this._reset(),t=Math.min(100,Math.max(0,t));const e=Math.round(this._charCount*t/100);let r=0;for(const n of this._map){let t=e-r;if(t<=0)break;n.length<t?(n.current=n.text,n.node.textContent=n.current,n.buffer.textContent="",r+=n.length):(n.current=n.text.substring(0,t),n.node.textContent=n.current,n.buffer.textContent=n.text.substring(n.current.length),r+=t)}}}function l(t){return new k(t)}var g,h=b&&b.__assign||function(){return(h=Object.assign||function(r){for(var $,a=1,n=arguments.length;a<n;a++)for(var o in $=arguments[a])Object.prototype.hasOwnProperty.call($,o)&&(r[o]=$[o]);return r}).apply(this,arguments)},m={wpm:200};window.roamkit||(window.roamkit={});var p=h(h({},m),null===(g=null===window||void 0===window?void 0:window.roamkit)||void 0===g?void 0:g.wpmPacemaker),q=p.wpm;function u(r,$,a,n){if(!r.onclick){var o=l($),t=a/n*6e4;console.log("Words: "+a),console.log("WPM: "+n),console.log("ms: "+t),r.onclick=function(){o.clear(),o.start(t)}}}var v=function(r){var $=r.closest(".rm-block-main").nextElementSibling;var $kgyi$$interop$default=j(f);$kgyi$$interop$default.d.count($,function(a){return u(r,$,a.words,q)})},w=function(){Array.from(document.querySelectorAll(".roam-article button")).filter(function(r){return"wpm"===r.textContent}).forEach(function(r){v(r)})};setInterval(w,1e3);if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=b}else if(typeof define==="function"&&define.amd){define(function(){return b})}})();